{{- define "main" }}

{{/* ===== FLOATING TOC (DÙNG CHUNG) ===== */}}
{{ partial "floating_toc.html" . }}

<main class="main">
  <div class="container">
    <article class="post-single">

      {{/* ===== POST HEADER (GIỮ PAPERMOD) ===== */}}
      <header class="post-header">
        {{ partial "breadcrumbs.html" . }}

        <h1 class="post-title">
          {{ .Title }}
          {{- if .Draft }}
          <span class="entry-hint" title="Draft">DRAFT</span>
          {{- end }}
        </h1>

        {{- if .Description }}
        <div class="post-description">
          {{ .Description }}
        </div>
        {{- end }}

        {{- if not (.Param "hideMeta") }}
        <div class="post-meta">
          {{ partial "post_meta.html" . }}
          {{ partial "translation_list.html" . }}
          {{ partial "edit_post.html" . }}
          {{ partial "post_canonical.html" . }}
        </div>
        {{- end }}
      </header>

      {{/* ===== COVER IMAGE (NẾU CÓ) ===== */}}
      {{- $isHidden := (.Param "cover.hiddenInSingle") | default (.Param "cover.hidden") | default false }}
      {{ partial "cover.html" (dict "cxt" . "IsSingle" true "isHidden" $isHidden) }}

      {{/* ===== CONTENT ===== */}}
      {{- if .Content }}
      <div class="post-content">
        {{- if not (.Param "disableAnchoredHeadings") }}
          {{ partial "anchored_headings.html" .Content }}
        {{- else }}
          {{ .Content }}
        {{- end }}
      </div>
      {{- end }}

      {{/* ===== FOOTER ===== */}}
      <footer class="post-footer">
        {{- $tags := .Language.Params.Taxonomies.tag | default "tags" }}
        <ul class="post-tags">
          {{- range ($.GetTerms $tags) }}
          <li>
            <a href="{{ .Permalink }}">{{ .LinkTitle }}</a>
          </li>
          {{- end }}
        </ul>

        {{- if (.Param "ShowPostNavLinks") }}
          {{ partial "post_nav_links.html" . }}
        {{- end }}

        {{- if (and site.Params.ShowShareButtons (ne .Params.disableShare true)) }}
          {{ partial "share_icons.html" . }}
        {{- end }}
      </footer>

      {{/* ===== COMMENTS ===== */}}
      {{- if (.Param "comments") }}
        {{ partial "comments.html" . }}
      {{- end }}

    </article>
  </div>
</main>

{{- end }}
